{"ast":null,"code":"var _jsxFileName = \"D:\\\\Exercises\\\\HTML\\\\DOM\\\\Test\\\\src\\\\common\\\\router\\\\FrontendAuth.js\";\n\n/**\r\n * 路由跳转的高阶组件\r\n * 负责权限验证\r\n */\nimport React from \"react\";\nimport { Route, Redirect } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass FrontendAuth extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {};\n  }\n\n  render() {\n    const {\n      routerConfig,\n      location\n    } = this.props;\n    const {\n      pathname\n    } = location;\n    const isLogin = sessionStorage.getItem(\"username\");\n    console.log(location);\n    console.log(pathname, isLogin);\n    const targetRouterConfig = routerConfig.find(item => item.path === pathname);\n\n    if (targetRouterConfig && !targetRouterConfig.auth && !isLogin) {\n      const {\n        component\n      } = targetRouterConfig;\n      return /*#__PURE__*/_jsxDEV(Route, {\n        exact: true,\n        path: pathname,\n        component: component\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 24,\n        columnNumber: 20\n      }, this);\n    }\n\n    if (isLogin) {\n      //如果是登陆状态，想要跳转到登陆，重定向到主页\n      if (pathname === \"/login\") {\n        return /*#__PURE__*/_jsxDEV(Redirect, {\n          to: \"/\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 29,\n          columnNumber: 24\n        }, this);\n      } else {\n        //如果路由合法，就跳转到相应的路由\n        if (targetRouterConfig) {\n          return /*#__PURE__*/_jsxDEV(Route, {\n            path: pathname,\n            component: targetRouterConfig.component\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 34,\n            columnNumber: 25\n          }, this);\n        } else {\n          //如果不合法，重定向到404页面\n          return /*#__PURE__*/_jsxDEV(Redirect, {\n            to: \"/404\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 38,\n            columnNumber: 28\n          }, this);\n        }\n      }\n    } else {\n      //非登陆状态下，当路由合法时且需要权限校验时，跳转到登陆页面，要求登陆\n      if (targetRouterConfig && targetRouterConfig.auth) {\n        return /*#__PURE__*/_jsxDEV(Redirect, {\n          to: \"/login\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 44,\n          columnNumber: 24\n        }, this);\n      } else {\n        //非登陆状态下，路由不合法时，重定向至404\n        return /*#__PURE__*/_jsxDEV(Redirect, {\n          to: \"/404\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 47,\n          columnNumber: 24\n        }, this);\n      }\n    }\n  }\n\n}\n\nexport default FrontendAuth;","map":{"version":3,"sources":["D:/Exercises/HTML/DOM/Test/src/common/router/FrontendAuth.js"],"names":["React","Route","Redirect","FrontendAuth","Component","constructor","props","state","render","routerConfig","location","pathname","isLogin","sessionStorage","getItem","console","log","targetRouterConfig","find","item","path","auth","component"],"mappings":";;AAAA;AACA;AACA;AACA;AAEA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAAQC,KAAR,EAAeC,QAAf,QAA8B,kBAA9B;;;AAEA,MAAMC,YAAN,SAA2BH,KAAK,CAACI,SAAjC,CAA2C;AACvCC,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACf,UAAMA,KAAN;AACA,SAAKC,KAAL,GAAa,EAAb;AACH;;AAEDC,EAAAA,MAAM,GAAG;AACL,UAAM;AAACC,MAAAA,YAAD;AAAeC,MAAAA;AAAf,QAA2B,KAAKJ,KAAtC;AACA,UAAM;AAACK,MAAAA;AAAD,QAAaD,QAAnB;AACA,UAAME,OAAO,GAAGC,cAAc,CAACC,OAAf,CAAuB,UAAvB,CAAhB;AACAC,IAAAA,OAAO,CAACC,GAAR,CAAYN,QAAZ;AACAK,IAAAA,OAAO,CAACC,GAAR,CAAYL,QAAZ,EAAsBC,OAAtB;AACA,UAAMK,kBAAkB,GAAGR,YAAY,CAACS,IAAb,CAAmBC,IAAD,IAAUA,IAAI,CAACC,IAAL,KAAcT,QAA1C,CAA3B;;AACA,QAAIM,kBAAkB,IAAI,CAACA,kBAAkB,CAACI,IAA1C,IAAkD,CAACT,OAAvD,EAAgE;AAC5D,YAAM;AAACU,QAAAA;AAAD,UAAcL,kBAApB;AACA,0BAAO,QAAC,KAAD;AAAO,QAAA,KAAK,MAAZ;AAAa,QAAA,IAAI,EAAEN,QAAnB;AAA6B,QAAA,SAAS,EAAEW;AAAxC;AAAA;AAAA;AAAA;AAAA,cAAP;AACH;;AACD,QAAIV,OAAJ,EAAa;AACT;AACA,UAAID,QAAQ,KAAK,QAAjB,EAA2B;AACvB,4BAAO,QAAC,QAAD;AAAU,UAAA,EAAE,EAAC;AAAb;AAAA;AAAA;AAAA;AAAA,gBAAP;AACH,OAFD,MAEO;AACH;AACA,YAAIM,kBAAJ,EAAwB;AACpB,8BACI,QAAC,KAAD;AAAO,YAAA,IAAI,EAAEN,QAAb;AAAuB,YAAA,SAAS,EAAEM,kBAAkB,CAACK;AAArD;AAAA;AAAA;AAAA;AAAA,kBADJ;AAGH,SAJD,MAIO;AACH;AACA,8BAAO,QAAC,QAAD;AAAU,YAAA,EAAE,EAAC;AAAb;AAAA;AAAA;AAAA;AAAA,kBAAP;AACH;AACJ;AACJ,KAfD,MAeO;AACH;AACA,UAAIL,kBAAkB,IAAIA,kBAAkB,CAACI,IAA7C,EAAmD;AAC/C,4BAAO,QAAC,QAAD;AAAU,UAAA,EAAE,EAAC;AAAb;AAAA;AAAA;AAAA;AAAA,gBAAP;AACH,OAFD,MAEO;AACH;AACA,4BAAO,QAAC,QAAD;AAAU,UAAA,EAAE,EAAC;AAAb;AAAA;AAAA;AAAA;AAAA,gBAAP;AACH;AACJ;AACJ;;AAzCsC;;AA4C3C,eAAelB,YAAf","sourcesContent":["/**\r\n * 路由跳转的高阶组件\r\n * 负责权限验证\r\n */\r\n\r\nimport React from \"react\";\r\nimport {Route, Redirect} from \"react-router-dom\"\r\n\r\nclass FrontendAuth extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {}\r\n    }\r\n\r\n    render() {\r\n        const {routerConfig, location} = this.props;\r\n        const {pathname} = location;\r\n        const isLogin = sessionStorage.getItem(\"username\");\r\n        console.log(location);\r\n        console.log(pathname, isLogin)\r\n        const targetRouterConfig = routerConfig.find((item) => item.path === pathname);\r\n        if (targetRouterConfig && !targetRouterConfig.auth && !isLogin) {\r\n            const {component} = targetRouterConfig;\r\n            return <Route exact path={pathname} component={component}/>\r\n        }\r\n        if (isLogin) {\r\n            //如果是登陆状态，想要跳转到登陆，重定向到主页\r\n            if (pathname === \"/login\") {\r\n                return <Redirect to=\"/\"/>\r\n            } else {\r\n                //如果路由合法，就跳转到相应的路由\r\n                if (targetRouterConfig) {\r\n                    return (\r\n                        <Route path={pathname} component={targetRouterConfig.component}/>\r\n                    );\r\n                } else {\r\n                    //如果不合法，重定向到404页面\r\n                    return <Redirect to=\"/404\"/>;\r\n                }\r\n            }\r\n        } else {\r\n            //非登陆状态下，当路由合法时且需要权限校验时，跳转到登陆页面，要求登陆\r\n            if (targetRouterConfig && targetRouterConfig.auth) {\r\n                return <Redirect to=\"/login\"/>\r\n            } else {\r\n                //非登陆状态下，路由不合法时，重定向至404\r\n                return <Redirect to=\"/404\"/>\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nexport default FrontendAuth;"]},"metadata":{},"sourceType":"module"}